<html dir="ltr">
<head>	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<title>Блоки визуализации</title></head>
<style>
@import "manual.css";
</style>
<body>
<h2>Введение</h2>
<p>Начиная с версии 1.3.5, в Scribus присутствует мощный инструмент под названием блоки визуализации. Первоначально задуманное как средство для вставки формул в документы Scribus, его создатель, Герман Краус (Hermann Kraus), позволил с его помощью создавать почти любой вид специального набора, такого как формулы, нотная запись или шахматная нотация, прямо в Scribus. Хитрость здесь заключается в том, что Scribus использует другие программы, запущенные в фоновом режиме, и импортирует их вывод в блоки специального типа, называемые <b>блоками визуализации</b>.</p>
<p>Хотя эта функция чрезвычайно универсальна, вы не должны забывать, что её использование требует знания кодов разметки, необходимых для конкретной программы. Эти коды в документации по Scribus не рассматриваются.</p>
<h2>Создание блока визуализации</h2>
<p>Для создания блока визуализации щёлкните значок блока визуализации на панели меню, выберите пункт меню <i>Вставка &gt; Блок визуализации</i> или нажмите клавишу D:</p>
<table width="100%"><tr><td align="center"><img src="images/rf2.png"></td></tr></table>
<table width="70%"><tr><td align="right"><p>Курсор превратится в символ кадра с буквой L внутри:</p></td><td align="left"><img src="images/DrawLatexFrame.png"></td></tr></table>

<p>В качестве следующего шага перетащите рамку и отпустите её, как вы делали для текстовых блоков. По умолчанию, Scribus выведет приветственное сообщение, в котором будет указано, что по крайней мере конфигурация для LaTeX является верной. Ниже вы можете увидеть вывод LaTeX, визуализированный в Scribus. Приветственное сообщение будет отображено на языке пользовательского интерфейса, установленного в меню <a href="settings1.html#1">Настроить Scribus</a>. Если перевод сообщения не доступен, будет показана английская версия:</p>
<table width="100%"><tr><td align="center"><img src="images/rf3.png"></td></tr></table>
<p>Снимок экрана, представленный выше, был сделан со стандартным разрешением, равным 72 dpi, что, очевидно, недостаточно для печати. Изменить разрешение, как вы увидите далее, достаточно просто.</p>
<h1>Изменение блоков визуализации</h1>
<p>При щелчке правой кнопкой мыши по блоку визуализации откроется контекстное меню, где одной из функций будет &#171;Изменить источник&#187;:</p>
<table width="100%"><tr><td align="center"><img src="images/rf4.png"></td></tr></table>
<p>Её выбор приведёт к открытию &#171;сердца&#187; блоков визуализации — окна редактора:</p>
<table width="100%"><tr><td align="center"><img src="images/rf5.png"></td></tr></table>
<p>В Scribus версии 1.4 редактор предварительно настроен для работы с LaTeX, Lilypond, gnuplot, dot/GraphViz и POV-Ray.</p>
<p>Слева находится поле с надписью &#171;Введите код&#187;. Здесь вы можете вставить код разметки для вывода, ожидаемого из внешней программы. Для предварительно настроенных визуализаторов в Scribus имеются простые фрагменты кода, которые позволят проверить, правильно ли установлены и настроены соответствующие программы. Как вы можете видеть, редактор обеспечивает выделение синтаксических элементов.</p>
<p>Кнопка &#171;Обновить&#187; под текстовым полем обновит содержимое блока визуализации, чтобы у вас была возможность увидеть результаты изменений разметки без закрытия окна редактора. Кнопка &#171;Вернуть&#187; служит для отмены любого изменения, произведённого с текстом. Обратите внимание, что после начала изменения текста будет невозможно изменить средство визуализации. Например, если вы начали редактировать исходный код LaTeX, вы больше не сможете переключиться на Lilypond.</p>
<p>Справа вы можете видеть ряд вкладок. Они доступны не для всех предварительно настроенных языков разметки, поэтому иногда редактор показывает только вкладку &#171;Параметры&#187;. </p>
<p>Первой записью на вкладке &#171;Параметры&#187; является &#171;Разрешение&#187;. Его значение по умолчанию — &#171;Автоматически&#187;, то есть 72 dpi, как было сказано выше. Значение разрешения при выводе можно легко изменить на что-нибудь более подходящее для печати.</p>
<p>Поле &#171;Программа&#187; содержит список поддерживаемых программ. В этом списке редактор отобразит все программы, заданные в меню <i>Файл &gt; Настроить Scribus &gt; Внешние инструменты</i>.</p>
<p>Если вы установите флажок &#171;Использовать преамбулу&#187;, редактор будет автоматически использовать начальную и заключительную части, как указано в файлах конфигурации XML. Более подробную информацию можно найти ниже.</p>
<p>В &#171;Сообщениях программы&#187; показываются сообщения, которые в противном случае отображались бы в интерпретаторе командной строки. Они &#171;перехватываются&#187; программой Scribus, как и окончательный вывод, и часто используются для обнаружения проблем в процессе визуализации.</p>
<p>При нажатии на &#171;Запустить внешний редактор&#187; Scribus запустит редактор, указанный в параметрах программы, а кнопка &#171;Убить программу&#187; остановит выполнение внешней программы. Это может быть полезно, когда внешняя программа сталкивается с ошибкой, допущенной в разметке, что приводит к остановке или даже сбою в работе внешней программы.</p>
<h2>Предварительно настроенные программы</h2>
<h3>LaTeX</h3>
<table width="100%"><tr><td align="center"><img src="images/rf6.png"></td></tr></table>
<p>Первая вкладка для LaTeX называется &#171;Шрифты и заголовки&#187;. В верхнем выпадающем списке вы можете указать шрифт, используемый в блоке визуализации с LaTeX. По умолчанию, в списке присутствует всего четыре шрифта, но можно легко добавить новые путём изменения файла конфигурации LaTeX способом, описанным далее: Просто добавьте ещё один шрифт под записью <code>&lt;list name=&quot;font&quot; default=&quot;&quot;&gt;</code> в файле. Обратите внимание на то, что список шрифтов для LaTeX (как и для других программ для разметки), скорее всего, будет кардинально отличаться от шрифтов, доступных в Scribus и других программах, поскольку программа LaTeX использует свои собственные шрифты и должна быть настроена на использование шрифтов типов Type 1, TrueType и OpenType, доступных в таких программах, как Scribus или LibreOffice. Дополнительные сведения о настройке шрифтов для LaTeX можно получить в <a href="http://www.latex-project.org/guides/fntguide.pdf">Руководстве по выбору шрифтов для LaTeX (PDF)</a>.</p>
<p>Следующий выпадающий список позволяет изменить кегль шрифта по умолчанию. Если вы уже пользовались LaTeX, то знаете, что этот параметр относится к основному шрифту. Другие необходимые размеры шрифта, например, для верхнего и нижнего индексов, определяются LaTeX. Вы также заметите, что в редакторе перечислены только некоторые размеры основного шрифта. Опять же, другие размеры можно с лёгкостью добавить под строкой <code>&lt;list name=&quot;fontsize&quot; default=&quot;11pt&quot;&gt;</code> в файле конфигурации LaTeX. Поскольку возможности настройки файла LaTeX практически не ограничены, вы можете выбрать различные файлы конфигурации XML в меню <i>Файл &gt; Настроить Scribus &gt; Внешние инструменты</i>.</p>
<p>Текстовое поле &#171;Дополнительные заголовки&#187; позволяет добавить дополнительные заголовки к преамбуле разметки LaTeX, которые будут сохранены в SLA-файле Scribus.</p>
<p>Наконец, можно увидеть различные вкладки с рисунками и символами, которые могут быть созданы при помощи LaTeX:</p>
<table width="100%"><tr><td align="center"><img src="images/rf7.png"></td></tr></table>
<p>Чтобы вставить символ в код разметки, можно либо выбрать символ и нажать кнопку &#171;Вставить символ&#187;, либо дважды щёлкнуть по значку символа.</p>
<p>Дополнительную информацию можно получить на <a href="http://www.latex-project.org/">официальном сайте LaTeX</a>.</p>

<h3>Lilypond</h3>

<table width="100%"><tr><td align="center"><img src="images/lilyp.png"></td></tr></table>

<p>Для Lilypond не доступно никаких дополнительных параметров.</p>
<p>Дополнительную информацию можно получить на <a href="http://lilypond.org/web/">официальном сайте Lilypond</a>.</p>

<h3>gnuplot</h3>

<table width="100%"><tr><td align="center"><img src="images/plot1.png"></td></tr></table>
<br>
<p>Функции gnuplot довольно просты. На вкладке &#171;Диапазоны&#187; можно задать начальные и конечные значения для шкал по осям X и Y. По умолчанию используется звёздочка, в результате чего gnuplot подбирает значения автоматически в соответствии со значениями, заданными в тексте разметки.</p>
<br>
<table width="100%"><tr><td align="center"><img src="images/plot2.png"></td></tr></table>
<br>
<p>Вкладка &#171;Метки&#187; служит помощником для задания некоторых визуальных аспектов графика:</p>

<ul>
<li>&#171;Название&#187; создаст заголовок для вашего графика, который будет размещён в верхней части визуализированного изображения.</li>
<li>&#171;Метка оси X&#187; и &#171;Метка оси Y&#187; создадут подписи к осям X и Y.</li>
<li>Действие полей &#171;Сетка&#187; и &#171;Слой сетки&#187; аналогично действию параметров направляющих/сетки страницы в Scribus, за исключением того, что сетка на графике станет частью визуализированного изображения. Для выбора доступны варианты полного отсутствия сетки, отображения основных линий сетки (&#171;Только основные линии&#187;) или же основных и вторичных линий сетки (&#171;Основные и вторичные линии&#187;). Так же, как и в Scribus, сетку можно отобразить на заднем или на переднем плане.</li>
<li>&#171;Начало координат&#187; создаст пунктирную линию для обозначения осей X и/или Y. Обратите внимание: сетка любого вида сделает использование начала координат ненужным, поскольку они с сеткой используют один и тот же цвет. Если вы хотите использовать разный стиль линий сетки и осей, вы должны указать это в тексте разметки. Аналогично, добавление оси Z требует редактирования исходного кода графа.</li>
</ul>

<p>Дополнительную информацию можно получить на <a href="http://www.gnuplot.info/">официальном сайте gnuplot</a>.</p>

<h3>dot/Graphviz</h3>

<p>Для dot/Graphviz не доступно никаких дополнительных параметров.</p>

<p>Дополнительную информацию можно получить на <a href="http://www.graphviz.org/">официальном сайте Graphviz</a>.</p>

<h3>POV-Ray</h3>

<table width="100%"><tr><td align="center"><img src="images/povray.png"></td></tr></table>
<br>
<p>Редактор предлагает только одну вкладку для визуализации файлов POV-Ray, а именно &#171;Параметры визуализации&#187;: </p>
<ul>
<li>&#171;Качество&#187; обеспечивает те же семь уровней качества, что и интерфейс командной строки POV-Ray, а редактор использует тот же уровень по умолчанию (&#171;Вычисление сред и диффузных отражений&#187; (&#171;Compute media and radiosity&#187;)). В противном случае уровни качества перечислены в порядке возрастания, где наихудшее качество обеспечивает уровень &#171;Показывать только быстрые цвета&#187;.</li>
<li>&#171;Сглаживание&#187; — это метод &#171;сглаживания&#187; краёв в визуализированном изображении. Оно может значительно улучшить качество изображения, но его использование может привести к гораздо более длительной визуализации. Параметры &#171;Порог сглаживания&#187; и &#171;Глубина сглаживания&#187; подробно описаны в документации по POV-Ray, но в большинстве случаев значений по умолчанию должно быть достаточно.</li></ul>

<p>Дополнительную информацию можно получить на <a href="http://www.povray.org/">официальном сайте POV-Ray</a>.</p>

<h2>Отрисовка</h2>
<p>После создания разметки по своему вкусу нажмите кнопку &#171;ОК&#187;.</p>
<p>Если вы допустили ошибку и внешняя программа не сможет отрисовать эту разметку, Scribus отобразит сообщение об ошибке:</p>
<table width="100%"><tr><td align="center"><img src="images/rf8.png"></td></tr></table>
<p><br><br>
</p>
<p>Помимо сообщения об ошибке, обозначением отсутствия отрисованного содержимого будет синий символ &#171;X&#187; в блоке визуализации:</p>
<table width="100%"><tr><td align="center"><img src="images/rf-error2.png"></td></tr></table>
<h2>Дополнительные примечания</h2>
<p>Взглянув на контекстное меню блоков визуализации, вы можете перепутать их с блоками изображений. И в какой-то степени будете правы, поскольку тут так же можно изменить параметры предварительного просмотра или обновить содержимое. Однако, есть одно существенное различие: как было сказано выше, текст разметки хранится в файле Scribus, а визуализируемое содержимое всегда создаётся &#171;на лету&#187;. Каджый раз, когда вы открываете файл Scribus, содержащий блок визуализации, будет запущена программа, необходимая для его отрисовки, и создан временный файл изображения, которое затем будет помещено в блок. Вот почему блоки визуализации не перечислены в разделе меню <i>Расширения &gt; Управление изображениями</i>.</p>
<p>У такого поведения имеются некоторые последствия. Хотя вы можете использовать файл Scribus с изображениями на другом компьютере, используя <i>Файл &gt; Собрать для вывода</i> и копируя полученный архив на другую машину, для блоков визуализации требуется наличие необходимого <i>программного обеспечения</i> на этой машине. Более того, функция может не работать на разных операционных системах из-за разных параметров командной строки.</p>
<p>Другое ограничение заключается в том, что не все графические эффекты могут быть применены к блокам визуализации.</p>

<h2>Конфигурация</h2>
<p>Для работы блоков визуализации на компьютере должны быть установлены необходимые программы. По умолчанию, в Scribus поддерживаются пять программ, а именно: LaTeX, Lilypond, gnuplot, dot/Graphviz и POV-Ray. В Linux диспетчер пакетов позаботится об установке и зависимостях программного обеспечения. На других платформах может понадобиться отдельная установка программ, а также изменение некоторых файлов конфигурации.</p>
<p>Если вы откроете вкладку &#171;Внешние инструменты&#187; в меню настройки, то увидите параметры настройки блоков визуализации в нижней части диалогового окна:</p>
<table width="100%"><tr><td align="center"><img src="images/rf1.png"></td></tr></table>

<p>В поле &#171;Конфигурации&#187; Scribus показывает стандартные файлы конфигурации. Для каждой программы, которую вы хотите использовать в Scribus, необходим отдельный файл конфигурации. Чтобы добавить новую программу для блоков визуализации, вы должны создать XML-файл с необходимыми параметрами. Ниже в качестве примера вы можете увидеть урезанный файл конфигурации gnuplot с комментариями:</p>

<p><code>&lt;editorsettings description=&quot;Gnuplot&quot; icon=&quot;gnuplot.png&quot;&gt;</code> Эта строчка задаёт описание программы, а также значок для выпадающего списка в редакторе блоков визуализации. Он должен храниться в том же каталоге, что и XML-файл. Для значка можно использовать файлы с расширением PNG, XPM или SVG.</p>
<p><code>&lt;executable command=&quot;gnuplot&quot;&gt;</code> Это команда запуска программы из командной строки. Можное использовать только программное обеспечение, которое может работать в командной строке. Кроме того, программа должна иметь возможность выводить данные в формате PNG, PDF или EPS. По умолчанию Scribus использует параметры командной строки для систем Linux/UNIX.</p>
<p><code>&lt;imagefile extension=&quot;.png&quot;/&gt;</code> Здесь можно указать редактору, какой формат файла следует ожидать от внешней программы.</p>
<p><code>&lt;highlighter&gt; &lt;/highlighter&gt;</code> Эта часть в основном интересна программистам, поскольку она позволяет создавать индивидуальные схемы выделения синтаксических элементов путём использования регулярных выражений. Дополнительную информацию можно получить по адресам <a href="http://docs.kde.org/kde3/en/kdeutils/KRegExpEditor/index.html">http://docs.kde.org/kde3/en/kdeutils/KRegExpEditor/index.html</a> и <a href="http://doc.trolltech.com/4.4/qregexp.html">http://doc.trolltech.com/4.4/qregexp.html</a>.</p>
<p><code>&lt;empty-frame-text&gt;</code> Здесь можно ввести пример текста на языке разметки программы, которую вы хотите использовать, например:</p>
<p><code>plot sin(x), (cos(x))**2</code></p>
<p><code>&lt;preamble&gt;</code> Если язык разметки, который вы хотите использовать, требует начальной части, вы можете ввести её здесь. В редакторе она показываться не будет.</p>
<p><code>&lt;postamble&gt;</code> Если язык разметки, который вы хотите использовать, требует конечной части, вы можете ввести её здесь. В редакторе она показываться не будет.</p>
<p><code>&lt;tab type=&quot;settings&quot;&gt;</code> Сюда с помощью простых записей XML могут быть добавлены переводы существующих строк GUI, а также новые вкладки или другие элементы пользовательского интерфейса, например:</p>
<p><code>&lt;title&gt;&lt;i18n&gt;</code>
<p6><code>
<ul>
<li>&lt;en&gt;Ranges&lt;/en&gt; <li>&lt;de&gt;Bereiche&lt;/de&gt;.org.org.org <li>&lt;fr&gt;Rang&#233;es&lt;/fr&gt; <li>&lt;pl&gt;Zakresy&lt;/pl&gt; <li>&lt;ru&gt;Диапазоны&lt;/ru&gt; </li></li></li></li></li></ul></code></p6>

<p>Для добавления нового файла конфигурации, нажмите кнопку &#171;Добавить...&#187;. Откроется диалоговое окно. Выберите ваш файл и нажмите &#171;Открыть&#187;. Файл будет добавлен в конфигурацию блока визуализации.</p>
<p>Перемещая записи XML выше или ниже по списку, можно изменить порядок записей в выпадающем списке редактора. Если вы хотите использовать другой файл конфигурации XML для определённого языка разметки (например, если вам нужна другая преамбула по умолчанию для блоков LaTeX в проекте), вы можете изменить путь к альтернативному файлу, нажав &#171;Изменить...&#187; или просто добавить новый файл конфигурации с соответствующим именем, например, &#171;MyLateX&#187;.</p>
<p>Если вы предпочитаете другой редактор для вашей разметки, например, если не можете жить без Emacs или vi, или если окно редактора просто слишком мало для вас, вы можете заменить встроенный редактор блоков визуализации Scribus на другой редактор, такой как vi или Kate. Просто вставьте путь к исполняемому файлу в текстовое поле &#171;Внешний редактор&#187;. Внешний редактор не будет переопределять редактор блоков визуализации: Как только вы сохраните разметку во внешнем редакторе, Scribus &#171;перехватит&#187; данные и отобразит вывод в блоке или же выведет сообщения об ошибках в поле &#171;сообщения программы&#187;. Перехват вывода также означает, что любое изменение текста разметки будет сохранено только в вашем файле Scribus. Если вы не указали внешний редактор в меню <i>Настроить Scribus &gt; Внешние инструменты</i>, Scribus выведет сообщение об ошибке:</p>
<br>
<table width="100%"><tr><td align="center"><img src="images/rf-error3.png"></td></tr></table>
<br>
<p>Кроме того, у вас есть возможность начать с пустого блока. Установив флажок &#171;Принудительное использование dpi&#187;, Scribus отрисует выход каждого блока визуализации с разрешением, указанным в поле счётчика справа. По умолчанию там из соображений производительности установлено значение 72 dpi. Если вы хотите создать документ для профессиональной печати, вам нужно будет выбрать более высокое разрешение.</p>
</body>
</html>
